#include "utils.h"
#include "tester.h"
#include "makeCopy.cpp"
#include "difference.cpp"
#include <string>
#include <iostream>
#include <stdexcept>

void Tester::scanForMalware() {
    logCmd("Update the clamav database");
    executeCommand("freshclam");
    logCmd("Scan the system");
    if (minimalScan) {
        executeCommand("cat /tmp/changed.txt | clamscan -");
    } else {
        executeCommand("clamscan -r");
    }
}